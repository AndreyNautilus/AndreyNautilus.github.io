<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>git push --force vs --force-with-lease | Andrey Nautilus blog</title><meta name=keywords content="git"><meta name=description content="Prefer 'git push --force-with-lease' over 'git push --force'"><meta name=author content><link rel=canonical href=https://andreynautilus.github.io/posts/2024-05-16-git-force-vs-force-with-lease/><link crossorigin=anonymous href=/assets/css/stylesheet.8fe10233a706bc87f2e08b3cf97b8bd4c0a80f10675a143675d59212121037c0.css integrity="sha256-j+ECM6cGvIfy4Is8+XuL1MCoDxBnWhQ2ddWSEhIQN8A=" rel="preload stylesheet" as=style><link rel=icon href=https://andreynautilus.github.io/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://andreynautilus.github.io/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://andreynautilus.github.io/favicon-32x32.png><link rel=apple-touch-icon href=https://andreynautilus.github.io/apple-touch-icon.png><link rel=mask-icon href=https://andreynautilus.github.io/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://andreynautilus.github.io/posts/2024-05-16-git-force-vs-force-with-lease/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><script type=text/javascript>(function(e,t,n,s,o,i,a){e[o]=e[o]||function(){(e[o].a=e[o].a||[]).push(arguments)},e[o].l=1*new Date;for(var r=0;r<document.scripts.length;r++)if(document.scripts[r].src===s)return;i=t.createElement(n),a=t.getElementsByTagName(n)[0],i.async=1,i.src=s,a.parentNode.insertBefore(i,a)})(window,document,"script","https://mc.yandex.ru/metrika/tag.js","ym"),ym(99367858,"init",{clickmap:!0,trackLinks:!0,accurateTrackBounce:!0})</script><noscript><div><img src=https://mc.yandex.ru/watch/99367858 style=position:absolute;left:-9999px alt></div></noscript><script async src="https://www.googletagmanager.com/gtag/js?id=G-S584PB390B"></script><script>window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-S584PB390B")</script><link rel=stylesheet href=/css/global/card_tags.min.08b084a05dddb2ae47b67783718d65c42eecc00cfee8c93fc63800741d66cc86.css integrity="sha256-CLCEoF3dsq5HtneDcY1lxC7swAz+6Mk/xjgAdB1mzIY=" as=style><link rel=stylesheet href=/css/global/builtin_icon.min.af7971272ac3da29f13218095878a0d6404d665d4c1192b7bfc4cc894d4eb76a.css integrity="sha256-r3lxJyrD2inxMhgJWHig1kBNZl1MEZK3v8TMiU1Ot2o=" as=style><link rel=stylesheet href=/css/global/columns.min.ad3ed875afa77918f5cc0b00a353ef761e69cccbe846e275bea3a8411ef7bd31.css integrity="sha256-rT7Yda+neRj1zAsAo1Pvdh5pzMvoRuJ1vqOoQR73vTE=" as=style><meta property="og:url" content="https://andreynautilus.github.io/posts/2024-05-16-git-force-vs-force-with-lease/"><meta property="og:site_name" content="Andrey Nautilus blog"><meta property="og:title" content="git push --force vs --force-with-lease"><meta property="og:description" content="Prefer 'git push --force-with-lease' over 'git push --force'"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="posts"><meta property="article:published_time" content="2024-05-16T20:36:19+02:00"><meta property="article:modified_time" content="2024-05-16T20:36:19+02:00"><meta property="article:tag" content="git"><meta name=twitter:card content="summary"><meta name=twitter:title content="git push --force vs --force-with-lease"><meta name=twitter:description content="Prefer 'git push --force-with-lease' over 'git push --force'"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"posts","item":"https://andreynautilus.github.io/posts/"},{"@type":"ListItem","position":2,"name":"git push --force vs --force-with-lease","item":"https://andreynautilus.github.io/posts/2024-05-16-git-force-vs-force-with-lease/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"git push --force vs --force-with-lease","name":"git push --force vs --force-with-lease","description":"Prefer 'git push --force-with-lease' over 'git push --force'","keywords":["git"],"articleBody":"Why do we need to force-push? Force-pushing is not always a bad thing. Sometimes we actually want to re-write the git history. This can be useful if:\nwe want to update a commit message of a previous commit (git commit --amend); we want to squash-merge dozens of small commits before presenting the code to the review (git rebase autosquash -i). When combined with fixup commits this allows to group changes in well-described commits; we want to remove sensitive information (like leaked credential) from the repository; we rebase our branch (on top of the updated main for example); In all these cases we actually want to re-write the git history, so we need to use force-push.\nA safer force-push But git push --force is a dangerous, unconditional override of the history on remote.\nIn git we usually have a branch per feature. This branch is usually maintained by a single developer from the creation till merge, and usually force-pushing to this branch is a relatively safe operation with low risk of overriding someones work. Still sometimes other authors (developers or automation) may push to your feature branch and we don’t want to lose these changes.\nTo completely avoid the risk, we should use git push --force-with-lease instead of git push --force. --force-with-lease will block the operation if the remote branch has changes that are not in your local copy. Official documentation has a bit more detailed explanation, but in simple words:\n--force-with-lease will not allow you to override someones changes that were not pulled to your local copy.\nAs a rule of thumb: always use --force-with-lease unless you have very good reasons to use --force.\nDanger zone If after re-writing your local history, but before pushing the changes to remote, you update your local remote-tracking branches (with git fetch for example), --force-with-lease will not save you from overriding others changes. In this case git assumes that’s your intention to override someones changes.\nExample Let’s simulate this scenario locally, I’ll use fixup commits as example. git can use a local repository as remote (I’ll use bare repository for this). We’re interested in commits, not the actual changes, so all commits will be empty (done with --allow-empty flag).\nInitial setup First, let’s create a remote (a bare git repository):\n$ mkdir remote $ cd remote remote $ git init --bare Mr.Green clones the repository, configures the user, initializes the main branch with an empty commit and pushes it to the remote:\n$ mkdir green $ git clone remote green $ cd green green $ git config --local user.name \"Alex Green\" green $ git config --local user.email \"alex.green@address.com\" green $ git commit -m \"initial commit\" --allow-empty green $ git push origin main Next, his co-worker, Mr.Red clones the repository and configures his user:\n$ mkdir red $ git clone remote red $ cd red red $ git config --local user.name \"Bob Red\" red $ git config --local user.email \"bob.red@address.com\" Now we have 2 clones from different people of the same remote.\nCreating a conflict Mr.Red creates a branch, makes a few changes and pushes the branch to the remote:\nred $ git checkout -b feature_branch red $ git commit -m \"change from Red 1\" --allow-empty red $ git commit --fixup HEAD --allow-empty red $ git push --set-upstream origin feature_branch Mr.Red invites his co-worker - Mr.Green - to help. Mr.Green checks out feature_branch, makes some changes and pushes the branch back to remote:\ngreen $ git pull green $ git checkout feature_branch green $ git commit -m \"change from Green 1\" --allow-empty green $ git push origin feature_branch In the meanwhile, Mr.Red continues to make changes. When ready, he squashes the changes to produce a “clean” history for the review process:\nred $ git commit --fixup HEAD~1 --allow-empty red $ git rebase --autosquash --interactive HEAD~3 # accept all changes Boom! Now the git history in Mr.Reds local copy has a conflict with the remote (what Mr.Green pushed):\nred $ git log --oneline feature_branch 266b934 (HEAD -\u003e feature_branch) change from Red 1 71737b9 (origin/main, origin/HEAD, main) initial commit green $ git log --oneline feature_branch fa25da6 (HEAD -\u003e feature_branch, origin/feature_branch) change from Green 1 c905bcf fixup! change from Red 1 863c570 change from Red 1 71737b9 (origin/main, main) initial commit (note the commit hashes!)\nHandling the conflict Mr.Red re-wrote the history of his branch, and if he tries to git push, the operation will fail. Mr.Red knows that he needs to force-push in order to send his branch to the remote.\nMr.Red might not be aware of the changes from Mr.Green, so using git push --force will override the commit from Mr.Green. --force-with-lease prevents it:\nred $ git push origin feature_branch --force-with-lease To C:/Projects/git_push_force_example/remote ! [rejected] feature_branch -\u003e feature_branch (stale info) error: failed to push some refs to 'C:/Projects/git_push_force_example/remote' Voila! Mr.Red didn’t override someones commit and needs to rebase and re-apply his changes.\nDanger zone If Mr.Red updates his local remote-tracking branches (with git fetch):\nred $ git log --oneline origin/feature_branch c905bcf (origin/feature_branch) fixup! change from Red 1 863c570 change from Red 1 71737b9 (origin/main, origin/HEAD, main) initial commit red $ git fetch red $ git log --oneline origin/feature_branch fa25da6 (origin/feature_branch) change from Green 1 c905bcf fixup! change from Red 1 863c570 change from Red 1 71737b9 (origin/main, origin/HEAD, main) initial commit the push operation will succeed and it will override the commit from Mr.Green on the remote. This happens, because git fetch brings the commit from Mr.Green to the local copy of Mr.Red, and git assumes that Mr.Red actually wants to override the commit from Mr.Green.\nConclusion Always prefer git push --force-with-lease over git push --force and use git fetch consciously.\n","wordCount":"935","inLanguage":"en","datePublished":"2024-05-16T20:36:19+02:00","dateModified":"2024-05-16T20:36:19+02:00","mainEntityOfPage":{"@type":"WebPage","@id":"https://andreynautilus.github.io/posts/2024-05-16-git-force-vs-force-with-lease/"},"publisher":{"@type":"Organization","name":"Andrey Nautilus blog","logo":{"@type":"ImageObject","url":"https://andreynautilus.github.io/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://andreynautilus.github.io/ accesskey=h title="Andrey Nautilus blog (Alt + H)"><img src=https://andreynautilus.github.io/apple-touch-icon.png alt aria-label=logo height=35>Andrey Nautilus blog</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://andreynautilus.github.io/links/ title=links><span>links</span></a></li><li><a href=https://andreynautilus.github.io/tags/ title=tags><span>tags</span></a></li><li><a href=https://andreynautilus.github.io/search/ title="search (Alt + /)" accesskey=/><span>search</span></a></li><li><a href=https://github.com/AndreyNautilus/AndreyNautilus.github.io title=src><span>src</span>&nbsp;
<svg fill="none" shape-rendering="geometricPrecision" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2.5" viewBox="0 0 24 24" height="12" width="12"><path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/><path d="M15 3h6v6"/><path d="M10 14 21 3"/></svg></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://andreynautilus.github.io/>Home</a>&nbsp;»&nbsp;<a href=https://andreynautilus.github.io/posts/>posts</a></div><h1 class="post-title entry-hint-parent">git push --force vs --force-with-lease</h1><div class=post-description>Prefer 'git push --force-with-lease' over 'git push --force'</div><div class=post-meta><span title='2024-05-16 20:36:19 +0200 +0200'>May 16, 2024</span>&nbsp;·&nbsp;5 min</div></header><div class=post-content><h2 id=why-do-we-need-to-force-push>Why do we need to force-push?<a hidden class=anchor aria-hidden=true href=#why-do-we-need-to-force-push>#</a></h2><p>Force-pushing is not always a bad thing. Sometimes we actually want to re-write the git history.
This can be useful if:</p><ul><li>we want to update a <a href=https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---amend>commit message</a>
of a previous commit (<code>git commit --amend</code>);</li><li>we want to squash-merge dozens of small commits before presenting the code to the review (<code>git rebase autosquash -i</code>).
When combined with <a href=https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---fixupamendrewordltcommitgt>fixup commits</a>
this allows to group changes in well-described commits;</li><li>we want to remove sensitive information (like leaked credential) from the repository;</li><li>we rebase our branch (on top of the updated main for example);</li></ul><p>In all these cases we actually want to re-write the git history, so we need to use <em>force</em>-push.</p><h2 id=a-safer-force-push>A safer force-push<a hidden class=anchor aria-hidden=true href=#a-safer-force-push>#</a></h2><p>But <code>git push --force</code> is a dangerous, unconditional override of the history on remote.</p><p>In <code>git</code> we usually have a branch per feature. This branch is <em>usually</em> maintained by a single developer
from the creation till merge, and <em>usually</em> force-pushing to this branch is a relatively safe operation
with low risk of overriding someones work. Still sometimes other authors (developers or automation) may
push to your feature branch and we don&rsquo;t want to lose these changes.</p><p>To completely avoid the risk, we should use <code>git push --force-with-lease</code> instead of <code>git push --force</code>.
<code>--force-with-lease</code> will block the operation if the remote branch has changes that are not in your local copy.
<a href=https://git-scm.com/docs/git-push#Documentation/git-push.txt---force-with-leaseltrefnamegt>Official documentation</a>
has a bit more detailed explanation, but in simple words:</p><blockquote><p><code>--force-with-lease</code> will not allow you to override someones changes that were not pulled to your local copy.</p></blockquote><p><strong>As a rule of thumb</strong>: always use <code>--force-with-lease</code> unless you have very good reasons to use <code>--force</code>.</p><h3 id=danger-zone>Danger zone<a hidden class=anchor aria-hidden=true href=#danger-zone>#</a></h3><p>If <em>after</em> re-writing your local history, but <em>before</em> pushing the changes to remote,
you <em>update</em> your local remote-tracking branches (with <code>git fetch</code> for example), <code>--force-with-lease</code> will <strong>not</strong> save you
from overriding others changes. In this case <code>git</code> assumes that&rsquo;s your intention to override someones changes.</p><h2 id=example>Example<a hidden class=anchor aria-hidden=true href=#example>#</a></h2><p>Let&rsquo;s simulate this scenario locally, I&rsquo;ll use <a href=https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---fixupamendrewordltcommitgt>fixup commits</a> as example.
<code>git</code> can use a local repository as remote (I&rsquo;ll use <em>bare</em> repository for this).
We&rsquo;re interested in commits, not the actual changes, so all commits will be empty
(done with <code>--allow-empty</code> <a href=https://git-scm.com/docs/git-commit#Documentation/git-commit.txt---allow-empty>flag</a>).</p><h3 id=initial-setup>Initial setup<a hidden class=anchor aria-hidden=true href=#initial-setup>#</a></h3><p>First, let&rsquo;s create a <em>remote</em> (a <a href=https://git-scm.com/docs/git-init#Documentation/git-init.txt-code--barecode><em>bare</em></a> git repository):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> mkdir remote
</span></span><span class=line><span class=cl><span class=gp>$</span> <span class=nb>cd</span> remote
</span></span><span class=line><span class=cl><span class=go>remote $ git init --bare
</span></span></span></code></pre></div><p>Mr.Green clones the repository, configures the user,
initializes the <code>main</code> branch with an empty commit and pushes it to the remote:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> mkdir green
</span></span><span class=line><span class=cl><span class=gp>$</span> git clone remote green
</span></span><span class=line><span class=cl><span class=gp>$</span> <span class=nb>cd</span> green
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>green $ git config --local user.name &#34;Alex Green&#34;
</span></span></span><span class=line><span class=cl><span class=go>green $ git config --local user.email &#34;alex.green@address.com&#34;
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>green $ git commit -m &#34;initial commit&#34; --allow-empty
</span></span></span><span class=line><span class=cl><span class=go>green $ git push origin main
</span></span></span></code></pre></div><p>Next, his co-worker, Mr.Red clones the repository and configures his user:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=gp>$</span> mkdir red
</span></span><span class=line><span class=cl><span class=gp>$</span> git clone remote red
</span></span><span class=line><span class=cl><span class=gp>$</span> <span class=nb>cd</span> red
</span></span><span class=line><span class=cl><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>red $ git config --local user.name &#34;Bob Red&#34;
</span></span></span><span class=line><span class=cl><span class=go>red $ git config --local user.email &#34;bob.red@address.com&#34;
</span></span></span></code></pre></div><p>Now we have 2 clones from different people of the same remote.</p><h3 id=creating-a-conflict>Creating a conflict<a hidden class=anchor aria-hidden=true href=#creating-a-conflict>#</a></h3><p>Mr.Red creates a branch, makes a few changes and pushes the branch to the remote:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>red $ git checkout -b feature_branch
</span></span></span><span class=line><span class=cl><span class=go>red $ git commit -m &#34;change from Red 1&#34; --allow-empty
</span></span></span><span class=line><span class=cl><span class=go>red $ git commit --fixup HEAD --allow-empty
</span></span></span><span class=line><span class=cl><span class=go>red $ git push --set-upstream origin feature_branch
</span></span></span></code></pre></div><p>Mr.Red invites his co-worker - Mr.Green - to help. Mr.Green checks out <code>feature_branch</code>,
makes some changes and pushes the branch back to remote:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>green $ git pull
</span></span></span><span class=line><span class=cl><span class=go>green $ git checkout feature_branch
</span></span></span><span class=line><span class=cl><span class=go>green $ git commit -m &#34;change from Green 1&#34; --allow-empty
</span></span></span><span class=line><span class=cl><span class=go>green $ git push origin feature_branch
</span></span></span></code></pre></div><p>In the meanwhile, Mr.Red continues to make changes. When ready, he squashes the changes
to produce a &ldquo;clean&rdquo; history for the review process:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>red $ git commit --fixup HEAD~1 --allow-empty
</span></span></span><span class=line><span class=cl><span class=go>red $ git rebase --autosquash --interactive HEAD~3  # accept all changes
</span></span></span></code></pre></div><p>Boom! Now the git history in Mr.Reds local copy has a conflict with the remote (what Mr.Green pushed):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>red $ git log --oneline feature_branch
</span></span></span><span class=line><span class=cl><span class=go>266b934 (HEAD -&gt; feature_branch) change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>71737b9 (origin/main, origin/HEAD, main) initial commit
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>green $ git log --oneline feature_branch
</span></span></span><span class=line><span class=cl><span class=go>fa25da6 (HEAD -&gt; feature_branch, origin/feature_branch) change from Green 1
</span></span></span><span class=line><span class=cl><span class=go>c905bcf fixup! change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>863c570 change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>71737b9 (origin/main, main) initial commit
</span></span></span></code></pre></div><p>(note the commit hashes!)</p><h3 id=handling-the-conflict>Handling the conflict<a hidden class=anchor aria-hidden=true href=#handling-the-conflict>#</a></h3><p>Mr.Red re-wrote the history of his branch, and if he tries to <code>git push</code>, the operation will fail.
Mr.Red knows that he needs to <em>force</em>-push in order to send his branch to the remote.</p><p>Mr.Red might not be aware of the changes from Mr.Green, so using <code>git push --force</code> will <em>override</em> the commit from Mr.Green.
<code>--force-with-lease</code> prevents it:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>red $ git push origin feature_branch --force-with-lease
</span></span></span><span class=line><span class=cl><span class=go>To C:/Projects/git_push_force_example/remote
</span></span></span><span class=line><span class=cl><span class=go> ! [rejected]        feature_branch -&gt; feature_branch (stale info)
</span></span></span><span class=line><span class=cl><span class=go>error: failed to push some refs to &#39;C:/Projects/git_push_force_example/remote&#39;
</span></span></span></code></pre></div><p>Voila! Mr.Red didn&rsquo;t override someones commit and needs to rebase and re-apply his changes.</p><h3 id=danger-zone-1>Danger zone<a hidden class=anchor aria-hidden=true href=#danger-zone-1>#</a></h3><p>If Mr.Red <em>updates</em> his local remote-tracking branches (with <code>git fetch</code>):</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-console data-lang=console><span class=line><span class=cl><span class=go>red $ git log --oneline origin/feature_branch
</span></span></span><span class=line><span class=cl><span class=go>c905bcf (origin/feature_branch) fixup! change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>863c570 change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>71737b9 (origin/main, origin/HEAD, main) initial commit
</span></span></span><span class=line><span class=cl><span class=go></span><span class=err>
</span></span></span><span class=line><span class=cl><span class=err></span><span class=go>red $ git fetch
</span></span></span><span class=line><span class=cl><span class=go>red $ git log --oneline origin/feature_branch
</span></span></span><span class=line><span class=cl><span class=go>fa25da6 (origin/feature_branch) change from Green 1
</span></span></span><span class=line><span class=cl><span class=go>c905bcf fixup! change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>863c570 change from Red 1
</span></span></span><span class=line><span class=cl><span class=go>71737b9 (origin/main, origin/HEAD, main) initial commit
</span></span></span></code></pre></div><p>the push operation <em>will succeed</em> and it <em>will override</em> the commit from Mr.Green on the remote.
This happens, because <code>git fetch</code> brings the commit from Mr.Green to the local copy of Mr.Red,
and <code>git</code> assumes that Mr.Red actually wants to override the commit from Mr.Green.</p><h2 id=conclusion>Conclusion<a hidden class=anchor aria-hidden=true href=#conclusion>#</a></h2><p>Always prefer <code>git push --force-with-lease</code> over <code>git push --force</code> and use <code>git fetch</code> consciously.</p></div><footer class=post-footer><ul class=post-tags><li><a href=https://andreynautilus.github.io/tags/git/>git</a></li></ul><nav class=paginav><a class=prev href=https://andreynautilus.github.io/posts/2024-05-22-git-multiple-users/><span class=title>« Prev</span><br><span>git with multiple users</span></a></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://andreynautilus.github.io/>Andrey Nautilus blog</a></span> ·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>